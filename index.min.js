!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).forceDirectedGraph=n()}(this,(function(){"use strict";var t={arcTween:function(t,n){return function(e){var i=d3.interpolate(e.endAngle,t);return function(t){return e.endAngle=i(t),n(e)}}},csv:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=t.join(", ");return n&&(e=e.replace(/, ([^,]*)$/," and $1")),e}};function n(){return["#a50026","#f46d43","#fdae61","#a6d96a","#66bd63","#006837"].reverse()}function e(){var t=n();return d3.scaleLinear().domain(d3.range(t.length)).range(t).clamp(!0)}var i={update:function(){var t=this;this.settings.explanation.forEach((function(t){})),this.settings.text=[].concat(this.settings.explanation.filter((function(n){return!(t.settings.hideControls&&n.includes("controls"))}))).concat(this.settings.information).filter((function(t){return"string"==typeof t}))},id_var:"id",event_var:"event",event_order_var:"event_order",start_timepoint_var:"stdy",end_timepoint_var:"endy",duration_var:"duration",sequence_var:"seq",timepoint:0,timeUnit:"days since randomization",duration:null,resetDelay:15e3,events:null,eventCentral:null,eventCount:!0,eventChangeCount:null,eventChangeCountAesthetic:"color",drawStaticSeparately:!0,speed:"medium",speeds:{slow:1e3,medium:500,fast:100},playPause:"play",pulseOrbits:!1,width:null,height:null,padding:1,nOrbits:null,orbitRadius:150,chargeStrength:null,staticLayout:"circular",nFoci:null,translate:!1,hideControls:!1,colorBy:{type:"frequency",variable:null,label:null},colors:n,colorScale:e,color:function(t){return e()(Math.min(t,e().domain().length))},fill:null,sizeBy:{type:"frequency",variable:null,label:null},minRadius:null,maxRadius:null,shape:"circle",modal:!0,modalSpeed:15e3,modalIndex:0,explanation:["Each bubble in this animation represents an individual.",'As <span class = "fdg-emphasized">time progresses</span> and individuals experience events, their bubble gravitates toward the focus or "planet" representing that event.','The <span class = "fdg-emphasized">number of events</span> an individual has experienced determines the color and/or size of their bubble.','<span class = "fdg-emphasized">Static bubbles</span> represent individuals who never experience an event.','Use the <span class = "fdg-emphasized">controls</span> on the right to interact with and alter the animation.',"Continue watching to learn how these individuals progress over the course of [duration] days."],information:null};function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function a(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function r(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?a(Object(e),!0).forEach((function(n){s(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,n){if(t){if("string"==typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}function u(t,n){var e;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=c(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,o=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return r=t.done,t},e:function(t){o=!0,a=t},f:function(){try{r||null==e.return||e.return()}finally{if(o)throw a}}}}function d(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div",i=n.append(e).classed("fdg-".concat(t),!0);return i}function h(t){var n=d("controls",t).classed("fdg-hidden",this.settings.hideControls);d("hide",n,"span");return{controls:n}}function g(t){var n=d("stopwatch",t).style("width","100%");return n.width=n.node().clientWidth,n.innerRadius=n.width/8,n.svg=d("stopwatch__svg",n,"svg").attr("width",n.width).attr("height",n.width),n.arc=d3.arc().innerRadius(n.innerRadius).outerRadius(n.width/2-1).cornerRadius(12).startAngle(0),n.g=d("stopwatch__path",n.svg,"g").attr("transform","translate(".concat(n.width/2,",").concat(n.width/2,")")),n.background=d("stopwatch__path",n.g,"path").datum({endAngle:2*Math.PI}).attr("d",n.arc).style("fill","white").style("stroke","black").style("stroke-width",.5),n.foreground=d("stopwatch__path",n.g,"path").datum({endAngle:0}).attr("d",n.arc).style("fill","#a6d96a").style("stroke","black").style("stroke-width",.5),n.percentBackground=d("stopwatch__text",n.g,"text").attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-weight","bold").style("stroke","white").style("stroke-width","4px").text("0%"),n.percentForeground=d("stopwatch__text",n.g,"text").attr("text-anchor","middle").attr("alignment-baseline","middle").style("font-weight","bold").text("0%"),n}function f(t){var n=this.settings.resetDelay/1e3;return d("countdown",t).classed("fdg-sidebar__label",!0).selectAll("div").data(d3.range(-1,n)).join("div").text((function(t){return"Looping in ".concat(t+1," second").concat(0===t?"":"s")})).classed("fdg-hidden",(function(t){return t!==n-1})).classed("fdg-invisible",(function(t){return t===n-1}))}function p(t){var n=d("sidebar",t),e=d("legends",n),i=d("progress",n),s=d("timer",i).classed("fdg-sidebar__label",!0);return{sidebar:n,legends:e,stopwatch:g.call(this,i),progress:i,timer:s,countdown:f.call(this,i),freqTable:d("freq-table",n)}}function v(t){var n=d("animation",t);this.settings.width=n.node().clientWidth,this.settings.height=n.node().clientHeight;var e=d("svg--background",n,"svg").attr("width",this.settings.width).attr("height",this.settings.height),i=d("canvas",n,"canvas").attr("width",this.settings.width).attr("height",this.settings.height);i.context=i.node().getContext("2d");var s=d("svg--foreground",n,"svg").attr("width",this.settings.width).attr("height",this.settings.height),a=d("modal",n);return{animation:n,svgBackground:e,canvas:i,svgForeground:s,modal:d("modal__text",a)}}function y(t){var n=this;this.settings.orbitRadius=this.settings.width/(t.orbit.length+1);var e=this.settings.orbitRadius/2,i=this.settings.height/2;Math.PI,this.settings.nFoci||(t.event.length,this.settings.eventCentral);t.event.forEach((function(t,s){t.radius=t.order*n.settings.orbitRadius,t.theta=2*Math.PI*t.position/360,t.x=0===t.order?e:e+t.radius*Math.cos(t.theta),t.y=0===t.order?i:i+t.radius*Math.sin(t.theta)})),t.orbit.forEach((function(t,s){t.cx=e,t.cy=i,t.r=(s+1)*n.settings.orbitRadius}))}function m(t,n,e){var i=void 0===n?null:n,s=function(t,n){var e=atob(t);if(n){for(var i=new Uint8Array(e.length),s=0,a=e.length;s<a;++s)i[s]=e.charCodeAt(s);return String.fromCharCode.apply(null,new Uint16Array(i.buffer))}return e}(t,void 0!==e&&e),a=s.indexOf("\n",10)+1,r=s.substring(a)+(i?"//# sourceMappingURL="+i:""),o=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(o)}var b,x,C,I,Q=(b="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIHNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy1kaXNwYXRjaC52Mi5taW4uanMnKTsKICAgIHNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy1xdWFkdHJlZS52Mi5taW4uanMnKTsKICAgIHNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy10aW1lci52Mi5taW4uanMnKTsKICAgIHNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy1mb3JjZS52Mi5taW4uanMnKTsKICAgIHNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9kMy1mb3JjZS1yZXVzZUAxLjAuMS9idWlsZC9kMy1mb3JjZS1yZXVzZS5taW4uanMnKTsKCiAgICBvbm1lc3NhZ2UgPSBmdW5jdGlvbiBvbm1lc3NhZ2UoZXZlbnQpIHsKICAgICAgdmFyIF9ldmVudCRkYXRhID0gZXZlbnQuZGF0YSwKICAgICAgICAgIG5vZGVzID0gX2V2ZW50JGRhdGEubm9kZXMsCiAgICAgICAgICBsYXlvdXQgPSBfZXZlbnQkZGF0YS5sYXlvdXQsCiAgICAgICAgICBzdHJlbmd0aCA9IF9ldmVudCRkYXRhLnN0cmVuZ3RoLAogICAgICAgICAgb3JiaXRSYWRpdXMgPSBfZXZlbnQkZGF0YS5vcmJpdFJhZGl1cywKICAgICAgICAgIHggPSBfZXZlbnQkZGF0YS54LAogICAgICAgICAgeSA9IF9ldmVudCRkYXRhLnksCiAgICAgICAgICByYWRpdXMgPSBfZXZlbnQkZGF0YS5yYWRpdXMsCiAgICAgICAgICBjb2xvciA9IF9ldmVudCRkYXRhLmNvbG9yOwogICAgICB2YXIgc2ltdWxhdGlvbiA9IGQzLmZvcmNlU2ltdWxhdGlvbigpLm5vZGVzKG5vZGVzKTsKICAgICAgaWYgKGxheW91dCA9PT0gJ2NpcmN1bGFyJykgc2ltdWxhdGlvbi5mb3JjZSgnY29sbGlkZScsIGQzLmZvcmNlQ29sbGlkZSgpLnJhZGl1cyhyYWRpdXMgKyAwLjUpKSAvLyBjb2xsaXNpb24gZGV0ZWN0aW9uCiAgICAgIC8vLmZvcmNlKCdjZW50ZXInLCBkMy5mb3JjZUNlbnRlcih4LCB5KSkgLy8gcG9zaXRpb25pbmcKICAgICAgLmZvcmNlKCdjaGFyZ2UnLCBkMy5mb3JjZU1hbnlCb2R5UmV1c2UoKS5zdHJlbmd0aChzdHJlbmd0aCkpIC8vIGNoYXJnZQogICAgICAuZm9yY2UoJ3gnLCBkMy5mb3JjZVgoeCkuc3RyZW5ndGgoMC4zKSkuZm9yY2UoJ3knLCBkMy5mb3JjZVkoeSkuc3RyZW5ndGgoMC4zKSk7ZWxzZSBpZiAobGF5b3V0ID09PSAncmFkaWFsJykgc2ltdWxhdGlvbi5mb3JjZSgnY29sbGlkZScsIGQzLmZvcmNlQ29sbGlkZSgpLnJhZGl1cyhyYWRpdXMgKyAwLjUpKSAvLyBjb2xsaXNpb24gZGV0ZWN0aW9uCiAgICAgIC5mb3JjZSgncicsIGQzLmZvcmNlUmFkaWFsKG9yYml0UmFkaXVzIC8gMikpOyAvLyBwb3NpdGlvbmluZwogICAgICAvLyBzdG9wIHNpbXVsYXRpb24KCiAgICAgIHNpbXVsYXRpb24uc3RvcCgpOyAvLyBpbmNyZW1lbnQgc2ltdWxhdGlvbiBtYW51YWxseQoKICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBNYXRoLmNlaWwoTWF0aC5sb2coc2ltdWxhdGlvbi5hbHBoYU1pbigpKSAvIE1hdGgubG9nKDEgLSBzaW11bGF0aW9uLmFscGhhRGVjYXkoKSkpOyBpIDwgbjsgKytpKSB7CiAgICAgICAgc2ltdWxhdGlvbi50aWNrKCk7CiAgICAgIH0gLy8gcmV0dXJuIHVwZGF0ZWQgbm9kZXMgYXJyYXkgdG8gYmUgZHJhd24gYW5kIGVuZGVyZWQKCgogICAgICBwb3N0TWVzc2FnZSh7CiAgICAgICAgbm9kZXM6IG5vZGVzLAogICAgICAgIHJhZGl1czogcmFkaXVzLAogICAgICAgIGNvbG9yOiBjb2xvcgogICAgICB9KTsKICAgIH07Cgp9KCkpOwoK",x="data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9yY2VTaW11bGF0aW9uV29ya2VyLmpzIiwic291cmNlcyI6WyJzcmMvaW5pdC9hZGRTdGF0aWNGb3JjZVNpbXVsYXRpb24vZm9yY2VTaW11bGF0aW9uV29ya2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbInNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy1kaXNwYXRjaC52Mi5taW4uanMnKTtcclxuc2VsZi5pbXBvcnRTY3JpcHRzKCdodHRwczovL2QzanMub3JnL2QzLXF1YWR0cmVlLnYyLm1pbi5qcycpO1xyXG5zZWxmLmltcG9ydFNjcmlwdHMoJ2h0dHBzOi8vZDNqcy5vcmcvZDMtdGltZXIudjIubWluLmpzJyk7XHJcbnNlbGYuaW1wb3J0U2NyaXB0cygnaHR0cHM6Ly9kM2pzLm9yZy9kMy1mb3JjZS52Mi5taW4uanMnKTtcclxuc2VsZi5pbXBvcnRTY3JpcHRzKCdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2QzLWZvcmNlLXJldXNlQDEuMC4xL2J1aWxkL2QzLWZvcmNlLXJldXNlLm1pbi5qcycpO1xyXG5cclxub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgICBub2RlcywgLy8gZGF0YVxyXG4gICAgICAgIGxheW91dCwgc3RyZW5ndGgsIG9yYml0UmFkaXVzLCAvLyBmb3JjZSBzaW11bGF0aW9uIHNldHRpbmdzXHJcbiAgICAgICAgeCwgeSwgLy8gY29vcmRpbmF0ZXNcclxuICAgICAgICByYWRpdXMsIGNvbG9yLCAvLyBhZXN0aGV0aWNzXHJcbiAgICB9ID0gZXZlbnQuZGF0YTtcclxuXHJcbiAgICBjb25zdCBzaW11bGF0aW9uID0gZDNcclxuICAgICAgICAuZm9yY2VTaW11bGF0aW9uKClcclxuICAgICAgICAubm9kZXMobm9kZXMpO1xyXG5cclxuICAgIGlmIChsYXlvdXQgPT09ICdjaXJjdWxhcicpXHJcbiAgICAgICAgc2ltdWxhdGlvblxyXG4gICAgICAgICAgICAuZm9yY2UoJ2NvbGxpZGUnLCBkMy5mb3JjZUNvbGxpZGUoKS5yYWRpdXMocmFkaXVzICsgMC41KSkgLy8gY29sbGlzaW9uIGRldGVjdGlvblxyXG4gICAgICAgICAgICAvLy5mb3JjZSgnY2VudGVyJywgZDMuZm9yY2VDZW50ZXIoeCwgeSkpIC8vIHBvc2l0aW9uaW5nXHJcbiAgICAgICAgICAgIC5mb3JjZSgnY2hhcmdlJywgZDMuZm9yY2VNYW55Qm9keVJldXNlKCkuc3RyZW5ndGgoc3RyZW5ndGgpKSAvLyBjaGFyZ2VcclxuICAgICAgICAgICAgLmZvcmNlKCd4JywgZDMuZm9yY2VYKHgpLnN0cmVuZ3RoKDAuMykpXHJcbiAgICAgICAgICAgIC5mb3JjZSgneScsIGQzLmZvcmNlWSh5KS5zdHJlbmd0aCgwLjMpKTtcclxuICAgIGVsc2UgaWYgKGxheW91dCA9PT0gJ3JhZGlhbCcpXHJcbiAgICAgICAgc2ltdWxhdGlvblxyXG4gICAgICAgICAgICAuZm9yY2UoJ2NvbGxpZGUnLCBkMy5mb3JjZUNvbGxpZGUoKS5yYWRpdXMocmFkaXVzICsgMC41KSkgLy8gY29sbGlzaW9uIGRldGVjdGlvblxyXG4gICAgICAgICAgICAuZm9yY2UoJ3InLCBkMy5mb3JjZVJhZGlhbChvcmJpdFJhZGl1cyAvIDIpKTsgLy8gcG9zaXRpb25pbmdcclxuXHJcbiAgICAvLyBzdG9wIHNpbXVsYXRpb25cclxuICAgIHNpbXVsYXRpb24uc3RvcCgpO1xyXG5cclxuICAgIC8vIGluY3JlbWVudCBzaW11bGF0aW9uIG1hbnVhbGx5XHJcbiAgICBmb3IgKHZhciBpID0gMCwgbiA9IE1hdGguY2VpbChNYXRoLmxvZyhzaW11bGF0aW9uLmFscGhhTWluKCkpIC8gTWF0aC5sb2coMSAtIHNpbXVsYXRpb24uYWxwaGFEZWNheSgpKSk7IGkgPCBuOyArK2kpIHtcclxuICAgICAgICBzaW11bGF0aW9uLnRpY2soKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXR1cm4gdXBkYXRlZCBub2RlcyBhcnJheSB0byBiZSBkcmF3biBhbmQgZW5kZXJlZFxyXG4gICAgcG9zdE1lc3NhZ2Uoe25vZGVzLHJhZGl1cyxjb2xvcn0pO1xyXG59O1xyXG4iXSwibmFtZXMiOlsic2VsZiIsImltcG9ydFNjcmlwdHMiLCJvbm1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJub2RlcyIsImxheW91dCIsInN0cmVuZ3RoIiwib3JiaXRSYWRpdXMiLCJ4IiwieSIsInJhZGl1cyIsImNvbG9yIiwic2ltdWxhdGlvbiIsImQzIiwiZm9yY2VTaW11bGF0aW9uIiwiZm9yY2UiLCJmb3JjZUNvbGxpZGUiLCJmb3JjZU1hbnlCb2R5UmV1c2UiLCJmb3JjZVgiLCJmb3JjZVkiLCJmb3JjZVJhZGlhbCIsInN0b3AiLCJpIiwibiIsIk1hdGgiLCJjZWlsIiwibG9nIiwiYWxwaGFNaW4iLCJhbHBoYURlY2F5IiwidGljayIsInBvc3RNZXNzYWdlIl0sIm1hcHBpbmdzIjoiOzs7SUFBQUEsSUFBSSxDQUFDQyxhQUFMLENBQW1CLHdDQUFuQjtJQUNBRCxJQUFJLENBQUNDLGFBQUwsQ0FBbUIsd0NBQW5CO0lBQ0FELElBQUksQ0FBQ0MsYUFBTCxDQUFtQixxQ0FBbkI7SUFDQUQsSUFBSSxDQUFDQyxhQUFMLENBQW1CLHFDQUFuQjtJQUNBRCxJQUFJLENBQUNDLGFBQUwsQ0FBbUIsK0VBQW5COztJQUVBQyxTQUFTLEdBQUcsbUJBQVNDLEtBQVQsRUFBZ0I7SUFBQSxvQkFNcEJBLEtBQUssQ0FBQ0MsSUFOYztJQUFBLE1BRXBCQyxLQUZvQixlQUVwQkEsS0FGb0I7SUFBQSxNQUdwQkMsTUFIb0IsZUFHcEJBLE1BSG9CO0lBQUEsTUFHWkMsUUFIWSxlQUdaQSxRQUhZO0lBQUEsTUFHRkMsV0FIRSxlQUdGQSxXQUhFO0lBQUEsTUFJcEJDLENBSm9CLGVBSXBCQSxDQUpvQjtJQUFBLE1BSWpCQyxDQUppQixlQUlqQkEsQ0FKaUI7SUFBQSxNQUtwQkMsTUFMb0IsZUFLcEJBLE1BTG9CO0lBQUEsTUFLWkMsS0FMWSxlQUtaQSxLQUxZO0lBUXhCLE1BQU1DLFVBQVUsR0FBR0MsRUFBRSxDQUNoQkMsZUFEYyxHQUVkVixLQUZjLENBRVJBLEtBRlEsQ0FBbkI7SUFJQSxNQUFJQyxNQUFNLEtBQUssVUFBZixFQUNJTyxVQUFVLENBQ0xHLEtBREwsQ0FDVyxTQURYLEVBQ3NCRixFQUFFLENBQUNHLFlBQUgsR0FBa0JOLE1BQWxCLENBQXlCQSxNQUFNLEdBQUcsR0FBbEMsQ0FEdEI7SUFFSTtJQUZKLEdBR0tLLEtBSEwsQ0FHVyxRQUhYLEVBR3FCRixFQUFFLENBQUNJLGtCQUFILEdBQXdCWCxRQUF4QixDQUFpQ0EsUUFBakMsQ0FIckI7SUFBQSxHQUlLUyxLQUpMLENBSVcsR0FKWCxFQUlnQkYsRUFBRSxDQUFDSyxNQUFILENBQVVWLENBQVYsRUFBYUYsUUFBYixDQUFzQixHQUF0QixDQUpoQixFQUtLUyxLQUxMLENBS1csR0FMWCxFQUtnQkYsRUFBRSxDQUFDTSxNQUFILENBQVVWLENBQVYsRUFBYUgsUUFBYixDQUFzQixHQUF0QixDQUxoQixFQURKLEtBT0ssSUFBSUQsTUFBTSxLQUFLLFFBQWYsRUFDRE8sVUFBVSxDQUNMRyxLQURMLENBQ1csU0FEWCxFQUNzQkYsRUFBRSxDQUFDRyxZQUFILEdBQWtCTixNQUFsQixDQUF5QkEsTUFBTSxHQUFHLEdBQWxDLENBRHRCO0lBQUEsR0FFS0ssS0FGTCxDQUVXLEdBRlgsRUFFZ0JGLEVBQUUsQ0FBQ08sV0FBSCxDQUFlYixXQUFXLEdBQUcsQ0FBN0IsQ0FGaEIsRUFwQm9CO0lBd0J4Qjs7SUFDQUssRUFBQUEsVUFBVSxDQUFDUyxJQUFYLEdBekJ3Qjs7SUE0QnhCLE9BQUssSUFBSUMsQ0FBQyxHQUFHLENBQVIsRUFBV0MsQ0FBQyxHQUFHQyxJQUFJLENBQUNDLElBQUwsQ0FBVUQsSUFBSSxDQUFDRSxHQUFMLENBQVNkLFVBQVUsQ0FBQ2UsUUFBWCxFQUFULElBQWtDSCxJQUFJLENBQUNFLEdBQUwsQ0FBUyxJQUFJZCxVQUFVLENBQUNnQixVQUFYLEVBQWIsQ0FBNUMsQ0FBcEIsRUFBd0dOLENBQUMsR0FBR0MsQ0FBNUcsRUFBK0csRUFBRUQsQ0FBakgsRUFBb0g7SUFDaEhWLElBQUFBLFVBQVUsQ0FBQ2lCLElBQVg7SUFDSCxHQTlCdUI7OztJQWlDeEJDLEVBQUFBLFdBQVcsQ0FBQztJQUFDMUIsSUFBQUEsS0FBSyxFQUFMQSxLQUFEO0lBQU9NLElBQUFBLE1BQU0sRUFBTkEsTUFBUDtJQUFjQyxJQUFBQSxLQUFLLEVBQUxBO0lBQWQsR0FBRCxDQUFYO0lBQ0gsQ0FsQ0Q7Ozs7OzsifQ==",C=!1,function(t){return I=I||m(b,x,C),new Worker(I,t)});function B(t,n,e,i){var s=new Q;return s.postMessage({nodes:t,layout:this.settings.staticLayout,strength:this.settings.chargeStrength,orbitRadius:this.settings.orbitRadius,x:n,y:e,radius:this.settings.minRadius,color:i}),s}function U(t,n){var e=this;t.onmessage=function(t){var n="fdg-static--".concat(t.data.color.replace(/[^0-9_a-z]/gi,"-"));e.containers.svgBackground.selectAll(".".concat(n)).remove();var i=e.containers.svgBackground.insert("g",":first-child").classed("fdg-static ".concat(n),!0);"radial"==e.settings.staticLayout&&i.attr("transform","translate(".concat(e.settings.orbitRadius/2,",").concat(e.settings.height/2,")"));i.selectAll(".fdg-static__circle").data(t.data.nodes).enter().append("circle").classed("fdg-static__circle",!0).attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})).attr("r",t.data.radius).attr("fill",t.data.color).attr("fill-opacity",.25)}}function F(){var t=this;if(this.settings.drawStaticSeparately){this.containers.svgBackground.selectAll(".fdg-static").remove();var n=this.data.nested.filter((function(t){return t.value.noStateChange})).map((function(t){return{key:t.key,category:t.value.category}}));if("categorical"===this.settings.colorBy.type)this.metadata.event[0].foci.forEach((function(e){var i=n.filter((function(t){return t.category===e.key})),s=B.call(t,i,e.x,e.y,t.colorScale(e.key));U.call(t,s)}));else{var e=B.call(this,n,this.settings.orbitRadius/2,this.settings.height/2,this.colorScale(0));U.call(this,e)}}}function w(){var t=this,n=this.containers.animation.node();this.settings.width=n.clientWidth,this.settings.height=this.containers.animation.node().clientHeight,this.containers.stopwatch.width=this.containers.stopwatch.node().clientWidth,this.containers.stopwatch.innerRadius=this.containers.stopwatch.width/8,this.containers.stopwatch.svg.attr("width",this.containers.stopwatch.width).attr("height",this.containers.stopwatch.width),this.containers.stopwatch.arc.innerRadius(this.containers.stopwatch.innerRadius).outerRadius(this.containers.stopwatch.width/2-1),this.containers.stopwatch.g.attr("transform","translate(".concat(this.containers.stopwatch.width/2,",").concat(this.containers.stopwatch.width/2,")")),this.containers.stopwatch.background.attr("d",this.containers.stopwatch.arc),this.containers.stopwatch.foreground.attr("d",this.containers.stopwatch.arc),this.containers.svgBackground.attr("width",this.settings.width).attr("height",this.settings.height),this.containers.canvas.attr("width",this.settings.width).attr("height",this.settings.height),this.containers.svgForeground.attr("width",this.settings.width).attr("height",this.settings.height),y.call(this,this.metadata),this.orbits.attr("cx",(function(t){return t.cx})).attr("cy",(function(t){return t.cy})).attr("r",(function(t){return t.r})),this.metadata.event.forEach((function(n){"categorical"===t.settings.colorBy.type?n.foci.forEach((function(e,i){e.x=n.x+50*Math.cos(i*t.settings.colorBy.theta),e.y=n.y+50*Math.sin(i*t.settings.colorBy.theta);var s=n.forceSimulation.find((function(t){return t.category===e.key}));s.force("x",d3.forceX(e.x).strength(.3)),s.force("y",d3.forceY(e.y).strength(.3))})):n.forceSimulation.forEach((function(t){t.force("x",d3.forceX(n.x).strength(.3)).force("y",d3.forceY(n.y).strength(.3))}))})),F.call(this),this.focusAnnotations.attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")}))}function A(){var t=d("main",d3.select(this.element)),n=h.call(this,t),e=p.call(this,t),i=v.call(this,t);return window.addEventListener("resize",w.bind(this)),r(r(r({main:t},n),e),i)}function L(){var t=this,n=d3.nest().key((function(t){return t.id})).rollup((function(n){return{duration:d3.sum(n,(function(t){return+t.duration})),static:1===n.length,category:"categorical"===t.settings.colorBy.type?n[0][t.settings.colorBy.variable]:null}})).entries(this.data);return n.forEach((function(t,n){Object.assign(t,t.value),t.value=t.key,t.duration=t.value,delete t.key})),n}function S(){var t=d3.nest().key((function(t){return t.event})).rollup((function(t){var n=t[0];return{order:parseInt(n.event_order),position:n.hasOwnProperty("event_position")?parseInt(n.event_position):null,count:0,prevCount:0,cumulative:0,nEvents:t.length}})).entries(this.data);return t.forEach((function(t){Object.assign(t,t.value),t.value=t.key,delete t.key})),d3.nest().key((function(t){return t.order})).rollup((function(t){var n=t.length,e=d3.range(-45,46);t.forEach((function(t,i){t.position=null===t.position?d3.quantile(e,(i+1)/(n+1)):t.position}))})).entries(t),t.sort((function(t,n){return t.order-n.order||n.nEvents-t.nEvents})),t}function k(t){var n=this;return d3.nest().key((function(t){return t.order})).entries(t.filter((function(t){return t.value!==n.settings.eventCentral})))}function Z(){var t=this,n={};n.id=L.call(this),this.settings.duration=this.settings.duration||d3.max(n.id,(function(t){return t.duration})),this.settings.text=this.settings.text.filter((function(e){return!(/static/i.test(e)&&(n.id.every((function(t){return!1===t.static}))||!1===t.settings.drawStaticSeparately))})).map((function(n){return n.replace("[duration]",d3.format(",d")(t.settings.duration))})),this.settings.minRadius=this.settings.minRadius||3e3/n.id.filter((function(n){return!(t.settings.drawStaticSeparately&&n.static)})).length,this.settings.staticRadius=this.settings.staticRadius||3e3/n.id.length,this.settings.maxRadius=this.settings.maxRadius||this.settings.minRadius+this.settings.colors().length,this.settings.chargeStrength=-2e3/n.id.filter((function(n){return!(t.settings.drawStaticSeparately&&n.static)})).length,this.settings.staticChargeStrength=-2e3/n.id.length,this.settings.fill=this.settings.fill||n.id.length<=2500,n.event=S.call(this),this.settings.eventCentral=this.settings.eventCentral||n.event[0].value,this.settings.nFoci=this.settings.nFoci||n.event.length-!!this.settings.eventCentral,this.settings.eventChangeCount=this.settings.eventChangeCount||n.event.slice(1).map((function(t){return t.value})),n.orbit=k.call(this,n.event),y.call(this,n);var e,i=this.settings.colors();if("frequency"===this.settings.colorBy.type)e=d3.range(i.length),this.colorScale=d3.scaleLinear().domain(e).range(i).clamp(!0);else if("continuous"===this.settings.colorBy.type){e=d3.extent(this.data,(function(n){return n[t.settings.colorBy.variable]})),this.colorScale=d3.scaleSequential(d3.interpolateRdYlGn).domain(e);var s=this.colorScale.interpolator();this.settings.colorBy.mirror&&this.colorScale.interpolator((function(t){return s(1-t)}))}else"categorical"===this.settings.colorBy.type&&(e=o(new Set(this.data.map((function(n){return n[t.settings.colorBy.variable]}))).values()).sort(),this.colorScale=d3.scaleOrdinal().domain(e).range(d3.schemeTableau10),this.settings.colorBy.theta=2*Math.PI/e.length,n.event.forEach((function(n){n.foci=e.map((function(e,i){return{key:e,x:n.x+50*Math.cos(i*t.settings.colorBy.theta),y:n.y+50*Math.sin(i*t.settings.colorBy.theta)}}))})));return this.domain=e,n}function R(t,n){var e=this;return void 0!==n?t[n]:t.find((function(n,i){return n.start_timepoint<=e.settings.timepoint&&e.settings.timepoint<=n.end_timepoint||i===t.length-1}))}function N(t){var n=this;return t.filter((function(t){return t.start_timepoint<=n.settings.timepoint})).sort((function(t,n){return t.start_timepoint-n.start_timepoint})).filter((function(t,e,i){var s=i[e-1]?i[e-1].event:null;return!n.settings.eventChangeCount.includes(s)&&n.settings.eventChangeCount.includes(t.event)})).length}function G(t){return"color"!==this.settings.eventChangeCountAesthetic?Math.min(this.settings.minRadius+t,this.settings.maxRadius):this.settings.minRadius}function _(t){var n="frequency"!==this.settings.colorBy.type||"size"!==this.settings.eventChangeCountAesthetic?d3.rgb(this.colorScale(t)).toString():"rgb(170,170,170)",e=n.replace("rgb","rgba").replace(")",", 0.5)"),i=n.replace("rgb","rgba").replace(")",", 1)");return{color:n,fill:e,stroke:i}}function W(t,n,e){var i=N.call(this,t,e),s="frequency"===this.settings.colorBy.type?i:n[this.settings.colorBy.variable];return r({nStateChanges:i,aesthetic:s,r:G.call(this,i)},_.call(this,s))}function M(){var t=this;this.metadata.event.forEach((function(t){t.prevCount=t.count})),this.data.nested.forEach((function(n){n.value.statePrevious=n.value.state;var e=t.metadata.event.find((function(t){return t.value===n.value.state.event}));n.value.distance=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),n.value.distance<t.settings.orbitRadius/4&&(n.value.state=R.call(t,n.value.group));var i=W.call(t,n.value.group,n.value.state,n.value.statePrevious);Object.assign(n.value,i)})),this.metadata.event.forEach((function(n){n.data=t.data.nested.filter((function(t,e){return t.value.state.event===n.value})),n.count=n.data.length,n.cumulative=t.data.filter((function(e){return e.event===n.value&&e.start_timepoint<=t.settings.timepoint})).length,n.change=n.count-n.prevCount}))}function J(){var t=this;this.settings.pulseOrbits&&this.orbits.each((function(n){n.change=d3.sum(n.values,(function(t){return t.change})),n.change>0&&d3.select(this).transition().duration(t.settings.speeds[t.settings.speed]/2).attr("stroke-width",.5*n.change).transition().duration(t.settings.speeds[t.settings.speed]/2).attr("stroke-width",.5)}))}function X(){var t=this;this.settings.progress=this.settings.timepoint/this.settings.duration,this.controls.timepoint.inputs.property("value",this.settings.timepoint),this.containers.timer.text("".concat(this.settings.timepoint," ").concat(this.settings.timeUnit)),this.containers.progress.attr("title","The animation is ".concat(d3.format(".1%")(this.settings.progress)," complete with ").concat(this.settings.duration-this.settings.timepoint," ").concat(this.settings.timeUnit.split(" ")[0]," to go.")),this.containers.stopwatch.foreground.transition().duration(this.settings.speed).attrTween("d",this.util.arcTween(this.settings.progress*Math.PI*2,this.containers.stopwatch.arc)).style("fill",d3.interpolateRdYlGn(1-this.settings.progress)),this.containers.stopwatch.percentBackground.text(this.settings.progress<.0095?d3.format(".1%")(this.settings.progress):d3.format(".0%")(this.settings.progress)),this.containers.stopwatch.percentForeground.text(this.settings.progress<.0095?d3.format(".1%")(this.settings.progress):d3.format(".0%")(this.settings.progress)),this.settings.eventCount&&this.focusAnnotations.selectAll("tspan.fdg-focus-annotation__event-count").text((function(n){return"".concat(n.count," (").concat(d3.format(".1%")(n.count/t.data.nested.length),")")})),this.freqTable.tr.selectAll("td").data((function(t){return[t.value,t.cumulative]})).join("td").text((function(t){return"number"==typeof t?d3.format(",d")(t):t}))}function E(){M.call(this),J.call(this),X.call(this)}function V(){var t=this,n=this.settings.resetDelay/1e3-1;return this.containers.countdown.classed("fdg-invisible",!1).classed("fdg-hidden",(function(t){return t!==n})),window.setInterval((function(){n--,t.containers.countdown.classed("fdg-hidden",(function(t){return t!==n}))}),1e3)}function Y(t){d3.select(this).transition().duration(t/15).delay(t-t/15*2).style("opacity",0)}function z(t,n){t.style("opacity",0).transition().duration(n/15).style("opacity",1).on("end",(function(){Y.call(this,n)}))}function j(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"outline",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"thick groove rgba(215,25,28,0)",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"thick groove rgba(215,25,28,.5)";t.style(n,e).transition().duration(this.settings.modalSpeed/15).style(n,i).transition().duration(this.settings.modalSpeed/15).delay(this.settings.modalSpeed-this.settings.modalSpeed/15*2).style(n,e).on("end",(function(){return t.style(n,null)}))}function H(){switch(this.modalText=this.settings.text[this.settings.modalIndex],this.settings.modalIndex===this.settings.text.length-1&&this.modal.stop(),this.containers.modal.html(this.modalText).call(z,this.settings.modalSpeed),!0){case/time/i.test(this.modalText):j.call(this,this.containers.progress);break;case/color/i.test(this.modalText):j.call(this,this.containers.legends);break;case/static/i.test(this.modalText):j.call(this,this.containers.svgBackground.selectAll("circle.fdg-static-circle"),"stroke","rgba(215,25,28,0)","rgba(215,25,28,.5)");break;case/controls/i.test(this.modalText):j.call(this,this.containers.controls)}}function D(){var t=this;H.call(this),this.modal=d3.interval((function(){t.settings.modalIndex++,H.call(t)}),this.settings.modalSpeed)}function T(){var t=this;this.settings.timepoint=0,this.settings.modalIndex=0,this.controls.timepoint.inputs.attr("value",0),this.metadata.event.forEach((function(t){t.prevCount=0,t.count=0,t.cumulative=0})),this.data.nested.forEach((function(n){n.value.statePrevious=null,n.value.state=R.call(t,n.value.group,0);var e=W.call(t,n.value.group,n.value.state,n.value.statePrevious);Object.assign(n.value,e)})),this.modal&&this.modal.stop(),D.call(this)}function K(t){var n=this,e=window.setTimeout((function(){T.call(n),n.containers.timer.text("".concat(n.settings.timepoint," ").concat(n.settings.timeUnit)),n.settings.progress=0,n.containers.stopwatch.foreground.transition().duration(n.settings.speed).attrTween("d",n.util.arcTween(n.settings.progress*Math.PI*2,n.containers.stopwatch.arc)).style("fill",d3.interpolateRdYlGn(1-n.settings.progress)),window.clearInterval(t),window.clearTimeout(e),n.containers.countdown.classed("fdg-invisible",(function(t){return t===n.settings.resetDelay/1e3-1})).classed("fdg-hidden",(function(t){return t!==n.settings.resetDelay/1e3-1})),n.interval=$.call(n)}),this.settings.resetDelay);return e}function O(){this.interval.stop();var t=V.call(this);K.call(this,t)}function P(){var t=this;this.metadata.event.forEach((function(n){n.forceSimulation.forEach((function(e){1===t.settings.timepoint&&e.force("center",null),e.nodes(n.data.filter((function(t){return!t.value.noStateChange&&t.value.category===e.category}))),e.alpha(1).restart()}))}))}var q=function(t){this.settings.timepoint+=!!t,this.settings.timepoint<=this.settings.duration?E.call(this):O.call(this),P.call(this)};function $(){return d3.interval(q.bind(this),this.settings.speeds[this.settings.speed])}var tt=[{action:"play",label:"Play",html:"&#9658;"},{action:"pause",label:"Pause",html:"&#10074;&#10074;"}];function nt(){var t=this;this.settings.playPause=tt.find((function(n){return n.action!==t.settings.playPause})).action,this.controls.playPause.inputs.attr("title","".concat(tt.find((function(n){return n.action!==t.settings.playPause})).label," animation")).html(tt.find((function(n){return n.action!==t.settings.playPause})).html),"play"===this.settings.playPause?this.interval=$.call(this):this.interval.stop()}function et(){var t=this,n=this,e=this.controls.container.append("div").classed("fdg-control fdg-control--speed",!0),i=e.selectAll("div").data(Object.keys(this.settings.speeds).map((function(n){return{label:n,value:t.settings.speeds[n]}}))).enter().append("div").attr("class",(function(n){return"fdg-button ".concat(n.label," ").concat(n.label===t.settings.speed?"current":"")})).attr("title",(function(n){return"Advance the animation every ".concat(t.settings.speeds[n.label]/1e3," second(s).")})).text((function(t){return t.label}));return i.on("click",(function(t){n.settings.speed=t.label,i.classed("current",(function(n){return n.label===t.label})),"play"===n.settings.playPause&&(n.interval.stop(),n.interval=$.call(n))})),{container:e,inputs:i}}function it(){var t=this,n=this.controls.container.append("div").classed("fdg-control fdg-control--play-pause",!0),e=n.append("div").classed("fdg-button fdg-input",!0).attr("title","".concat(tt.find((function(n){return n.action!==t.settings.playPause})).label," animation.")).html(tt.find((function(n){return n.action!==t.settings.playPause})).html);return e.on("click",(function(){nt.call(t)})),{container:n,inputs:e}}function st(){var t=this,n=this.controls.container.append("div").classed("fdg-control fdg-control--step",!0),e=n.append("div").classed("fdg-button fdg-input",!0).attr("title","Advance animation by one time unit.").text("Step");return e.on("click",(function(){"pause"!==t.settings.playPause&&nt.call(t),q.call(t,!0)})),{container:n,inputs:e}}function at(){var t=this,n=this,e=this.controls.container.append("div").classed("fdg-control fdg-control--timepoint",!0),i=e.append("div").classed("fdg-button fdg-input",!0).append("input").attr("type","number").attr("title","Choose a timepoint.").attr("value",+this.settings.timepoint).attr("min",1).attr("max",this.settings.duration);return i.on("click",(function(){"pause"!==t.settings.playPause&&nt.call(t)})),i.on("change",(function(){"pause"!==n.settings.playPause&&nt.call(n),n.settings.timepoint=+this.value-1,q.call(n,!0)})),{container:e,inputs:i}}function rt(){var t=this,n=this.controls.container.append("div").classed("fdg-control fdg-control--reset",!0),e=n.append("div").classed("fdg-button fdg-input",!0).attr("title","Reset animation.").html("&#x21ba;");return e.on("click",(function(){T.call(t),"play"!==t.settings.playPause&&nt.call(t)})),{container:n,inputs:e}}function ot(){var t=this,n=this,e=this.controls.container.append("div").classed("fdg-control fdg-control--event-list",!0),i=e.selectAll("div").data(this.metadata.event).enter().append("div").attr("class",(function(n){return"fdg-button ".concat(t.settings.eventChangeCount.includes(n.value)?"current":"")})).attr("title",(function(n){return"".concat(t.settings.eventChangeCount.includes(n.value)?"Remove":"Add"," ").concat(n.value," ").concat(t.settings.eventChangeCount.includes(n.value)?"from":"to"," the list of events that control bubble ").concat("both"===t.settings.eventChangeCountAesthetic?"color and size":t.settings.eventChangeCountAesthetic,".")})).text((function(t){return t.value}));return i.on("click",(function(t){var e=this;this.classList.toggle("current"),n.settings.eventChangeCount.includes(this.textContent)?n.settings.eventChangeCount.splice(n.settings.eventChangeCount.findIndex((function(t){return t===e.textContent})),1):n.settings.eventChangeCount.push(this.textContent),this.title="".concat(n.settings.eventChangeCount.includes(t.value)?"Remove":"Add"," ").concat(t.value," ").concat(n.settings.eventChangeCount.includes(t.value)?"from":"to"," the list of events that control bubble ").concat("both"===n.settings.eventChangeCountAesthetic?"color and size":n.settings.eventChangeCountAesthetic,"."),n.controls.colorSizeToggle.inputs.attr("title",(function(t){return"Quantify the number of ".concat(n.util.csv(n.settings.eventChangeCount)," events by ").concat("both"!==t?t:"color and size",".")})),n.legends.container.classed("fdg-invisible",0===n.settings.eventChangeCount.length).selectAll("span.fdg-measure").text(n.util.csv(n.settings.eventChangeCount)),q.call(n,!1)})),{container:e,inputs:i}}function ct(){var t=this,n=this,e=this.controls.container.append("div").classed("fdg-control fdg-control--color-size",!0),i=e.selectAll("div").data(["color","size","both"]).enter().append("div").attr("class",(function(n){return"fdg-button ".concat(n," ").concat(n===t.settings.eventChangeCountAesthetic?"current":"")})).attr("title",(function(e){return"Quantify the number of ".concat(n.util.csv(t.settings.eventChangeCount)," events by ").concat("both"!==e?e:"color and size")})).text((function(t){return t}));return i.on("click",(function(t){i.classed("current",(function(n){return n===t})),n.settings.eventChangeCountAesthetic=t,n.controls.eventList.inputs.attr("title",(function(t){return"".concat(n.settings.eventChangeCount.includes(t.value)?"Remove":"Add"," ").concat(t.value," ").concat(n.settings.eventChangeCount.includes(t.value)?"from":"to"," the list of events that control bubble ").concat("both"===n.settings.eventChangeCountAesthetic?"color and size":n.settings.eventChangeCountAesthetic,".")})),n.legends.container.selectAll(".fdg-legend").classed("fdg-hidden",(function(){return!Array.from(this.classList).some((function(n){return n.includes(t)}))})),q.call(n,!1)})),{container:e,inputs:i}}function lt(){this.controls={container:this.containers.controls},this.controls.speed=et.call(this),this.controls.playPause=it.call(this),this.controls.step=st.call(this),this.controls.timepoint=at.call(this),this.controls.reset=rt.call(this),"frequency"===this.settings.colorBy.type&&(this.controls.eventList=ot.call(this),this.controls.colorSizeToggle=ct.call(this)),this.controls.container.selectAll(".fdg-button").on("mousedown",(function(){this.classList.toggle("clicked")})).on("mouseup",(function(){this.classList.toggle("clicked")})).on("mouseout",(function(){this.classList.contains("clicked")&&this.classList.toggle("clicked")}))}function ut(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,e=document.createElement("canvas");e.width=n,e.height=1;for(var i=e.getContext("2d"),s=0;s<n;++s)i.fillStyle=t(s/(n-1)),i.fillRect(s,0,1,1);return e}var dt={color:function(t,n){var e=this;return t.selectAll("rect.legend-mark").data(this.settings.colors()).enter().append("rect").classed("legend-mark",!0).attr("x",(function(t,i){return i*(n[0]/e.settings.colors().length)})).attr("y",0).attr("width",n[0]/this.settings.colors().length).attr("height",n[1]/3).attr("fill",(function(t){return t})).attr("fill-opacity",.5).attr("stroke",(function(t){return t})).attr("stroke-opacity",1)},size:function(t,n){var e=this;return t.selectAll("circle.legend-mark").data(this.settings.colors()).enter().append("circle").classed("legend-mark",!0).attr("cx",(function(t,i){return i*(n[0]/e.settings.colors().length)+n[0]/e.settings.colors().length/2})).attr("cy",n[1]/4).attr("r",(function(t,n){return n+e.settings.minRadius})).attr("fill","#aaa").attr("fill-opacity",.5).attr("stroke","#aaa").attr("stroke-opacity",1)},both:function(t,n){var e=this;return t.selectAll("circle.legend-mark").data(this.settings.colors()).enter().append("circle").classed("legend-mark",!0).attr("cx",(function(t,i){return i*(n[0]/e.settings.colors().length)+n[0]/e.settings.colors().length/2})).attr("cy",n[1]/4).attr("r",(function(t,n){return n+e.settings.minRadius})).attr("fill",(function(t){return t})).attr("fill-opacity",.5).attr("stroke",(function(t){return t})).attr("stroke-opacity",1)}};function ht(t){var n=[200,50],e=this.legends.container.append("div").classed("fdg-legend fdg-legend--".concat(t),!0).classed("fdg-hidden",this.settings.eventChangeCountAesthetic!==t||0===this.settings.eventChangeCount.length),i=e.append("div").classed("fdg-sidebar__label fdg-legend__label",!0).html('Number of <span class = "fdg-measure">'.concat(this.util.csv(this.settings.eventChangeCount),"</span> events")),s=e.append("svg").attr("width",n[0]).attr("height",n[1]).append("g"),a=dt[t].call(this,s,n),r=s.append("text").attr("x",n[0]/this.settings.colors().length/2).attr("y",n[1]/2+16).attr("text-anchor","middle").text("0"),o=s.append("text").attr("x",n[0]-n[0]/this.settings.colors().length/2).attr("y",n[1]/2+16).attr("text-anchor","middle").text("".concat(this.settings.colors().length-1,"+"));return{container:e,label:i,svg:s,marks:a,lower:r,upper:o}}function gt(){var t=this;if(this.legends={container:this.containers.legends},"continuous"===this.settings.colorBy.type)this.legends.container.append("div").classed("fdg-legend fdg-legend--continuous",!0).node().appendChild(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.color,i=n.title,s=n.tickSize,a=void 0===s?6:s,r=n.width,o=void 0===r?320:r,c=n.height,l=void 0===c?44+a:c,u=n.marginTop,d=void 0===u?18:u,h=n.marginRight,g=void 0===h?0:h,f=n.marginBottom,p=void 0===f?16+a:f,v=n.marginLeft,y=void 0===v?0:v,m=n.ticks,b=void 0===m?o/64:m,x=n.tickFormat,C=n.tickValues,I=d3.create("svg").attr("width",o).attr("height",l).attr("viewBox",[0,0,o,l]).style("overflow","visible"),Q=function(t){return t.selectAll(".tick line").attr("y1",d+p-l)};if(e.interpolate){var B=Math.min(e.domain().length,e.range().length);t=e.copy().rangeRound(d3.quantize(d3.interpolate(y,o-g),B)),I.append("image").attr("x",y).attr("y",d).attr("width",o-y-g).attr("height",l-d-p).attr("preserveAspectRatio","none").attr("xlink:href",ut.call(this,e.copy().domain(d3.quantize(d3.interpolate(0,1),B))).toDataURL())}else if(e.interpolator){if(t=Object.assign(e.copy().interpolator(d3.interpolateRound(y,o-g)),{range:function(){return[y,o-g]}}),I.append("image").attr("x",y).attr("y",d).attr("width",o-y-g).attr("height",l-d-p).attr("preserveAspectRatio","none").attr("xlink:href",ut.call(this,e.interpolator()).toDataURL()),!t.ticks){if(void 0===C){var U=Math.round(b+1);C=d3.range(U).map((function(t){return d3.quantile(e.domain(),t/(U-1))}))}"function"!=typeof x&&(x=d3.format(void 0===x?",f":x))}}else if(e.invertExtent){var F=e.thresholds?e.thresholds():e.quantiles?e.quantiles():e.domain(),w=void 0===x?function(t){return t}:"string"==typeof x?d3.format(x):x;t=d3.scaleLinear().domain([-1,e.range().length-1]).rangeRound([y,o-g]),I.append("g").selectAll("rect").data(e.range()).join("rect").attr("x",(function(n,e){return t(e-1)})).attr("y",d).attr("width",(function(n,e){return t(e)-t(e-1)})).attr("height",l-d-p).attr("fill",(function(t){return t})),C=d3.range(F.length),x=function(t){return w(F[t],t)}}else t=d3.scaleBand().domain(e.domain()).rangeRound([y,o-g]),I.append("g").selectAll("rect").data(e.domain()).join("rect").attr("x",t).attr("y",d).attr("width",Math.max(0,t.bandwidth()-1)).attr("height",l-d-p).attr("fill",e),Q=function(){};return I.append("g").attr("transform","translate(0,".concat(l-p,")")).call(d3.axisBottom(t).ticks(b,"string"==typeof x?x:void 0).tickFormat("function"==typeof x?x:void 0).tickSize(a).tickValues(C)).call(Q).call((function(t){return t.select(".domain").remove()})).call((function(t){return t.append("text").classed("fdg-sidebar__label fdg-legend__label",!0).attr("x",y).attr("y",d+p-l-6).attr("fill","currentColor").attr("text-anchor","middle").attr("transform","translate(".concat(o/2,",0)")).attr("font-weight","bold").attr("font-size","1.25rem").text(i)})),I.node()}({color:this.colorScale,title:this.settings.colorBy.label,width:200,height:50,tickValues:[this.colorScale.domain()[0],(this.colorScale.domain()[1]-this.colorScale.domain()[0])/2,this.colorScale.domain()[1]]}));else if("categorical"===this.settings.colorBy.type){var n=this.legends.container.append("div").classed("fdg-legend fdg-legend--categorical",!0);n.append("div").classed("fdg-sidebar__label fdg-legend__label",!0).text(this.settings.colorBy.label);var e=n.append("svg").attr("width",200).attr("height",20*this.colorScale.domain().length).selectAll("g").data(this.colorScale.domain()).join("g");e.append("circle").attr("cx",20).attr("cy",(function(t,n){return 20*n+10})).attr("r",7).attr("fill",(function(n){return t.colorScale(n)})),e.append("text").attr("font-size","1rem").attr("x",35).attr("y",(function(t,n){return 20*n+12})).attr("alignment-baseline","middle").text((function(n){return"".concat(n," (n=").concat(t.metadata.id.filter((function(t){return t.category===n})).length,")")}))}else"frequency"===this.settings.colorBy.type&&(this.legends.color=ht.call(this,"color"),this.legends.size=ht.call(this,"size"),this.legends.both=ht.call(this,"both"))}function ft(){var t={container:this.containers.freqTable};return t.table=t.container.append("table"),t.thead=t.table.append("thead"),t.th=t.thead.append("th").classed("fdg-sidebar__label",!0).attr("colspan",2).text("Cumulative Number of Events"),t.tbody=t.table.append("tbody"),t.tr=t.tbody.selectAll("tr").data(this.metadata.event.slice(1)).join("tr"),t.td=t.tr.selectAll("td").data((function(t){return[t.value,t.cumulative]})).join("td").text((function(t){return"number"==typeof t?d3.format(",d")(t):t})),t}function pt(){var t=this.containers.svgBackground.append("g").classed("fdg-g fdg-g--orbits",!0);return t.append("defs").selectAll("filter").data(this.metadata.orbit).join("filter").attr("id",(function(t,n){return"orbit--".concat(n)})).append("feDropShadow").attr("dx",0).attr("dy",0).attr("stdDeviation",5).attr("flood-color","black"),t.selectAll("circle.orbit").data(this.metadata.orbit).enter().append("circle").classed("orbit",!0).attr("cx",(function(t){return t.cx})).attr("cy",(function(t){return t.cy})).attr("r",(function(t){return t.r})).attr("fill","none").attr("stroke","#aaa").attr("stroke-width",".5").style("filter",(function(t,n){return"url(#orbit--".concat(n,")")}))}function vt(){var t=this,n=this.containers.svgForeground.append("g").classed("fdg-g fdg-g--focus-annotations",!0).selectAll("g.fdg-focus-annotation").data(this.metadata.event).join("g").classed("fdg-focus-annotation",!0).attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})),e=function(n){return Math.round(n.x)===Math.round(t.settings.orbitRadius/2)},i=function(n){return 1===n.order||Math.round(n.x)<Math.round(t.settings.width/2)},s=function(t){return e(t)?"middle":i(t)?"start":"end"},a=function(n){return Math.round(n.y)===Math.round(t.settings.height/2)},r=function(n){return Math.round(n.y)<Math.round(t.settings.height/2)};return["background","foreground"].forEach((function(o){var c=n.append("text").classed("fdg-focus-annotation__text fdg-focus-annotation__".concat(o),!0);c.style("transform",(function(t){return"translate(".concat(function(t){return e(t)?0:i(t)?"2em":"-2em"}(t),",").concat(function(t){return a(t)?0:r(t)?"-2em":"2em"}(t),")")}));var l=c.append("tspan").classed("fdg-focus-annotation__label",!0).attr("x",0).attr("text-anchor",(function(t){return s(t)})).text((function(t){return t.value})),u=c.append("tspan").classed("fdg-focus-annotation__event-count",!0).classed("fdg-hidden",!1===t.settings.eventCount).attr("x",0).attr("dy","1.3em").attr("text-anchor",(function(t){return s(t)}));"categorical"===t.settings.colorBy.type&&(c.style("transform",(function(t){return"translate(0,".concat(a(t)?"0":r(t)?"5em":"-5em",")")})),l.attr("text-anchor","middle"),u.attr("text-anchor","middle"))})),n}function yt(){lt.call(this),gt.call(this),this.containers.timer.text("".concat(this.settings.timepoint," ").concat(this.settings.timeUnit)),this.freqTable=ft.call(this),this.orbits=pt.call(this),this.focusAnnotations=vt.call(this)}function mt(){var t,n={},e=u(Object.keys(this.settings).filter((function(t){return/_var$/.test(t)})));try{for(e.s();!(t=e.n()).done;){var i=t.value;n[i.replace(/_var$/,"")]=this.data[0].hasOwnProperty(this.settings[i])}}catch(t){e.e(t)}finally{e.f()}return n}function bt(){var t=this;this.data.forEach((function(n){var e,i=u(Object.keys(t.settings).filter((function(t){return/_var$/.test(t)})));try{for(i.s();!(e=i.n()).done;){var s=e.value,a=s.replace(/_var$/,"");n[a]=["event_order","start_timepoint","end_timepoint","duration","sequence"].includes(a)?+n[t.settings[s]]:n[t.settings[s]]}}catch(t){i.e(t)}finally{i.f()}}))}function xt(t){d3.nest().key((function(t){return t.id})).rollup((function(n){n.forEach((function(e,i){t.duration&&!t.start_timepoint&&(0===i?(e.start_timepoint=1,e.end_timepoint=e.duration):(e.start_timepoint=n[i-1].end_timepoint+1,e.end_timepoint=e.start_timepoint+e.duration-1)),t.start_timepoint&&!t.end_timepoint&&(e.end_timepoint=i<n.length-1?n[i+1].start_timepoint-1:e.duration?e.start_timepoint+e.duration-1:e.start_timepoint),!t.duration&&t.start_timepoint&&t.end_timepoint&&(e.duration=e.start_timepoint-e.end_timepoint+1)})),t.sequence?n.sort((function(t,n){return t.seq-n.seq})):n.sort((function(t,n){return t.start_timepoint-n.start_timepoint})).forEach((function(t,n){t.seq=n}))})).entries(this.data)}function Ct(){var t=this.data.every((function(t){return/^-?\d+\.?\d*$/.test(t.id)||/^-?\d*\.?\d+$/.test(t.id)}));this.data.sort((function(n,e){var i=t?+n.id-+e.id:n.id<e.id?-1:e.id<n.id?1:0,s=n.seq-e.seq;return i||s}))}function It(){var t=mt.call(this);bt.call(this),xt.call(this,t),Ct.call(this)}function Qt(){var t=this;return d3.nest().key((function(t){return t.id})).rollup((function(n){var e=d3.sum(n,(function(t){return t.duration})),i="categorical"===t.settings.colorBy.type?n[0][t.settings.colorBy.variable]:null,s=R.call(t,n,0),a=1===n.length&&s.event===t.settings.eventCentral,o=t.metadata.event.find((function(t){return t.value===s.event})),c={x:o.x,y:o.y},l=W.call(t,n,s,null);return r({group:n,duration:e,category:i,statePrevious:null,state:s,noStateChange:a,coordinates:c},l)})).entries(this.data)}function Bt(){var t=this;It.call(this),this.data.nested=Qt.call(this),this.metadata.event.forEach((function(n){n.data=t.data.nested.filter((function(t){return t.value.state.event===n.value}))}))}function Ut(t){return function(){return t}}function Ft(t,n,e,i){if(isNaN(n)||isNaN(e))return t;var s,a,r,o,c,l,u,d,h,g=t._root,f={data:i},p=t._x0,v=t._y0,y=t._x1,m=t._y1;if(!g)return t._root=f,t;for(;g.length;)if((l=n>=(a=(p+y)/2))?p=a:y=a,(u=e>=(r=(v+m)/2))?v=r:m=r,s=g,!(g=g[d=u<<1|l]))return s[d]=f,t;if(o=+t._x.call(null,g.data),c=+t._y.call(null,g.data),n===o&&e===c)return f.next=g,s?s[d]=f:t._root=f,t;do{s=s?s[d]=new Array(4):t._root=new Array(4),(l=n>=(a=(p+y)/2))?p=a:y=a,(u=e>=(r=(v+m)/2))?v=r:m=r}while((d=u<<1|l)==(h=(c>=r)<<1|o>=a));return s[h]=g,s[d]=f,t}function wt(t,n,e,i,s){this.node=t,this.x0=n,this.y0=e,this.x1=i,this.y1=s}function At(t){return t[0]}function Lt(t){return t[1]}function St(t,n,e){var i=new kt(null==n?At:n,null==e?Lt:e,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function kt(t,n,e,i,s,a){this._x=t,this._y=n,this._x0=e,this._y0=i,this._x1=s,this._y1=a,this._root=void 0}function Zt(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Rt=St.prototype=kt.prototype;function Nt(){var t=this;this.containers.canvas.context.clearRect(0,0,this.settings.width,this.settings.height),this.containers.canvas.context.save(),this.data.nested.sort((function(t,n){return t.value.stateChanges-n.value.stateChanges})).forEach((function(n,e){t.containers.canvas.context.beginPath(),t.containers.canvas.context.moveTo(n.x+n.r,n.y),t.containers.canvas.context.arc(n.x,n.y,n.value.r,0,2*Math.PI),t.settings.fill&&(t.containers.canvas.context.fillStyle=n.value.fill,t.containers.canvas.context.fill()),t.containers.canvas.context.strokeStyle=n.value.stroke,t.containers.canvas.context.stroke()})),this.containers.canvas.context.restore()}function Gt(t,n,e){var i=d3.forceSimulation().nodes(t).alphaDecay(.01).velocityDecay(.9).force("center",d3.forceCenter(this.settings.orbitRadius/2,this.settings.height/2)).force("x",d3.forceX(n).strength(.3)).force("y",d3.forceY(e).strength(.3)).force("charge",function(){var t,n,e,i,s,a,r,o=0,c=Ut(-30),l=1,u=1/0,d=.81;function h(){return 1e-6*(Math.random()-.5)}function g(t){return t.x}function f(t){return t.y}function p(s){var r,c=t.length;for(i&&!a(o,t)||(i=St(t,g,f).visitAfter(y),t.update.push(o)),e=s,r=0;r<c;++r)n=t[r],i.visit(m);++o}function v(){if(t){o=0,t.update=[],a=s(),i=null;var n,e,l=t.length;for(r=new Array(l),n=0;n<l;++n)e=t[n],r[e.index]=+c(e,n,t)}}function y(t){var n,e,i,s,a,o=0,c=0;if(t.length){for(i=s=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(o+=n.value,c+=e,i+=e*n.x,s+=e*n.y);t.x=i/c,t.y=s/c}else{(n=t).x=n.data.x,n.y=n.data.y;do{o+=r[n.data.index]}while(n=n.next)}t.value=o}function m(t,i,s,a){if(!t.value)return!0;var o=t.x-n.x,c=t.y-n.y,g=a-i,f=o*o+c*c;if(g*g/d<f)return f<u&&(0===o&&(f+=(o=h())*o),0===c&&(f+=(c=h())*c),f<l&&(f=Math.sqrt(l*f)),n.vx+=o*t.value*e/f,n.vy+=c*t.value*e/f),!0;if(!(t.length||f>=u)){(t.data!==n||t.next)&&(0===o&&(f+=(o=h())*o),0===c&&(f+=(c=h())*c),f<l&&(f=Math.sqrt(l*f)));do{t.data!==n&&(f=(o=t.data.x-n.x)*o+(c=t.data.y-n.y)*c,0===o&&(f+=(o=h())*o),0===c&&(f+=(c=h())*c),f<l&&(f=Math.sqrt(l*f)),g=r[t.data.index]*e/f,n.vx+=o*g,n.vy+=c*g)}while(t=t.next)}}return s=function(){return function(t){return t%13==0}},p.initialize=function(n){t=n,v()},p.strength=function(t){return arguments.length?(c="function"==typeof t?t:Ut(+t),v(),p):c},p.distanceMin=function(t){return arguments.length?(l=t*t,p):Math.sqrt(l)},p.distanceMax=function(t){return arguments.length?(u=t*t,p):Math.sqrt(u)},p.theta=function(t){return arguments.length?(d=t*t,p):Math.sqrt(d)},p.update=function(t){return arguments.length?(a=(s=t)(),p):s},p}().strength(this.settings.chargeStrength)).on("tick",Nt.bind(this));return i.force("collide",d3.forceCollide().radius(this.settings.minRadius+1)),i}function _t(){var t=this;D.call(this),F.call(this),this.metadata.event.forEach((function(n){if(void 0===n.foci){var e=Gt.call(t,n.data.filter((function(t){return!t.value.noStateChange})),n.x,n.y);e.category=null,e.coordinates=[n.x,n.y],n.forceSimulation=[e]}else n.forceSimulation=n.foci.map((function(e){var i=Gt.call(t,n.data.filter((function(t){return!t.value.noStateChange&&t.value.category===e.key})),e.x,e.y);return i.category=e.key,i.coordinates=[e.x,e.y],i}))})),"play"===this.settings.playPause&&(this.interval=$.call(this))}return Rt.copy=function(){var t,n,e=new kt(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return e;if(!i.length)return e._root=Zt(i),e;for(t=[{source:i,target:e._root=new Array(4)}];i=t.pop();)for(var s=0;s<4;++s)(n=i.source[s])&&(n.length?t.push({source:n,target:i.target[s]=new Array(4)}):i.target[s]=Zt(n));return e},Rt.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return Ft(this.cover(n,e),n,e,t)},Rt.addAll=function(t){var n,e,i,s,a=t.length,r=new Array(a),o=new Array(a),c=1/0,l=1/0,u=-1/0,d=-1/0;for(e=0;e<a;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(s=+this._y.call(null,n))||(r[e]=i,o[e]=s,i<c&&(c=i),i>u&&(u=i),s<l&&(l=s),s>d&&(d=s));if(c>u||l>d)return this;for(this.cover(c,l).cover(u,d),e=0;e<a;++e)Ft(this,r[e],o[e],t[e]);return this},Rt.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,i=this._y0,s=this._x1,a=this._y1;if(isNaN(e))s=(e=Math.floor(t))+1,a=(i=Math.floor(n))+1;else{for(var r,o,c=s-e,l=this._root;e>t||t>=s||i>n||n>=a;)switch(o=(n<i)<<1|t<e,(r=new Array(4))[o]=l,l=r,c*=2,o){case 0:s=e+c,a=i+c;break;case 1:e=s-c,a=i+c;break;case 2:s=e+c,i=a-c;break;case 3:e=s-c,i=a-c}this._root&&this._root.length&&(this._root=l)}return this._x0=e,this._y0=i,this._x1=s,this._y1=a,this},Rt.data=function(){var t=[];return this.visit((function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)})),t},Rt.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Rt.find=function(t,n,e){var i,s,a,r,o,c,l,u=this._x0,d=this._y0,h=this._x1,g=this._y1,f=[],p=this._root;for(p&&f.push(new wt(p,u,d,h,g)),null==e?e=1/0:(u=t-e,d=n-e,h=t+e,g=n+e,e*=e);c=f.pop();)if(!(!(p=c.node)||(s=c.x0)>h||(a=c.y0)>g||(r=c.x1)<u||(o=c.y1)<d))if(p.length){var v=(s+r)/2,y=(a+o)/2;f.push(new wt(p[3],v,y,r,o),new wt(p[2],s,y,v,o),new wt(p[1],v,a,r,y),new wt(p[0],s,a,v,y)),(l=(n>=y)<<1|t>=v)&&(c=f[f.length-1],f[f.length-1]=f[f.length-1-l],f[f.length-1-l]=c)}else{var m=t-+this._x.call(null,p.data),b=n-+this._y.call(null,p.data),x=m*m+b*b;if(x<e){var C=Math.sqrt(e=x);u=t-C,d=n-C,h=t+C,g=n+C,i=p.data}}return i},Rt.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(r=+this._y.call(null,t)))return this;var n,e,i,s,a,r,o,c,l,u,d,h,g=this._root,f=this._x0,p=this._y0,v=this._x1,y=this._y1;if(!g)return this;if(g.length)for(;;){if((l=a>=(o=(f+v)/2))?f=o:v=o,(u=r>=(c=(p+y)/2))?p=c:y=c,n=g,!(g=g[d=u<<1|l]))return this;if(!g.length)break;(n[d+1&3]||n[d+2&3]||n[d+3&3])&&(e=n,h=d)}for(;g.data!==t;)if(i=g,!(g=g.next))return this;return(s=g.next)&&delete g.next,i?(s?i.next=s:delete i.next,this):n?(s?n[d]=s:delete n[d],(g=n[0]||n[1]||n[2]||n[3])&&g===(n[3]||n[2]||n[1]||n[0])&&!g.length&&(e?e[h]=g:this._root=g),this):(this._root=s,this)},Rt.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},Rt.root=function(){return this._root},Rt.size=function(){var t=0;return this.visit((function(n){if(!n.length)do{++t}while(n=n.next)})),t},Rt.visit=function(t){var n,e,i,s,a,r,o=[],c=this._root;for(c&&o.push(new wt(c,this._x0,this._y0,this._x1,this._y1));n=o.pop();)if(!t(c=n.node,i=n.x0,s=n.y0,a=n.x1,r=n.y1)&&c.length){var l=(i+a)/2,u=(s+r)/2;(e=c[3])&&o.push(new wt(e,l,u,a,r)),(e=c[2])&&o.push(new wt(e,i,u,l,r)),(e=c[1])&&o.push(new wt(e,l,s,a,u)),(e=c[0])&&o.push(new wt(e,i,s,l,u))}return this},Rt.visitAfter=function(t){var n,e=[],i=[];for(this._root&&e.push(new wt(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var s=n.node;if(s.length){var a,r=n.x0,o=n.y0,c=n.x1,l=n.y1,u=(r+c)/2,d=(o+l)/2;(a=s[0])&&e.push(new wt(a,r,o,u,d)),(a=s[1])&&e.push(new wt(a,u,o,c,d)),(a=s[2])&&e.push(new wt(a,r,d,u,l)),(a=s[3])&&e.push(new wt(a,u,d,c,l))}i.push(n)}for(;n=i.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},Rt.x=function(t){return arguments.length?(this._x=t,this):this._x},Rt.y=function(t){return arguments.length?(this._y=t,this):this._y},function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={data:n,element:e,settings:Object.assign(i,s),util:t};return i.update.call(a),a.containers=A.call(a),a.metadata=Z.call(a),yt.call(a),Bt.call(a),_t.call(a),a}}));
